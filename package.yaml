spec-version: 0.30.0
name: preql
version: 0.3
synopsis: safe PostgreSQL queries using Quasiquoters
description: |
  Before you Post(gres)QL, preql.

  @preql@ provides a low-level interface to PostgreSQL and a quasiquoter that converts
  inline variable names to SQL parameters.  Higher-level interfaces, checking SQL syntax &
  schema, are planned.

  the [quickstart](https://github.com/bergey/preql#quickstart) 
  or the [vision](https://github.com/bergey/preql#vision-parsing-sql-in-haskell-quasiquotes)

  Most applications will want to import the top-level module @Preql@.  When writing @SQL@
  instances or your own higher-level abstractions, you may want the lower-level,
  IO-specific functions in @Preql.Wire@, not all of which are re-exported from @Preql@.
    
category: Database, PostgreSQL
github: bergey/preql
author: Daniel Bergey
maintainer: bergey@teallabs.org
extra-doc-files:
  - CHANGELOG.md

library:
  source-dirs: [src]
  ghc-options: "-O2"

tests:
  tests:
    source-dirs: test
    main: Test.hs
    dependencies:
      - preql
      - tasty >= 1.1 && < 1.4
      - tasty-hunit >= 0.10 && < 0.11

build-tools:
  - alex
  - happy
      
dependencies:
    - aeson >= 1.3.1 && < 1.6
    - array >= 0.5.2 && < 0.6
    - base >= 4.11 && < 4.15 # GHC 8.4; need CPP semigroup/monoid to go earlier
    - binary-parser >= 0.5.5 && < 0.6
    - bytestring >= 0.10.8 && < 0.11
    - bytestring-strict-builder >= 0.4.5 && < 0.5
    - contravariant >= 1.4.1 && < 1.6
    - free >= 5.0.2 && < 5.2
    - mtl >= 2.2.2 && < 2.3
    - postgresql-binary >= 0.12.1 && < 0.13
    - postgresql-libpq >= 0.9.4 && < 0.10
    - scientific >= 0.3.6 && < 0.4
    - template-haskell >= 2.13.0 && < 2.17
    - text >= 1.2.3 && < 1.3
    - th-lift-instances >= 0.1.11 && < 0.2
    - time >= 1.8.0 && < 1.10
    - transformers >= 0.5.5 && < 0.6
    - uuid >= 1.3.13 && < 1.4
    - vector >= 0.12.0 && < 0.13

default-extensions:
  - OverloadedStrings

benchmarks:
  pgbench:
    main: Bench.hs
    source-dirs:
      - benchmark
    dependencies:
      - preql
      - criterion
      - deepseq

executables:
  preql-load:
    main: Load.hs
    source-dirs:
      - load-test
    dependencies:
      - preql
      - deepseq
      - optparse-applicative
      - resource-pool
      - stm
    ghc-options: "-rtsopts -threaded -eventlog -O2 -fprof-auto -fprof-cafs"
